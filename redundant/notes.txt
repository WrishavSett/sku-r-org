Master table column heading and data:

itemcode, catcode, category, subcat, ssubcat, company, mbrand, brand, sku, packtype, base_pack, multipack, flavor, color, wght, uom, hpkcnv, msu, launchdate, qty, mrp, status, factcode, activeitem, active, nepalcomm, flag, audittype, price_seg, filter_seg, DELYM
20110041, 118, SOFT DRINKS-NP, SOFT DRINKS, CARBONATED, PEPSI COLA CMPNY IMPRTD-IMPRTD, 7 UP, 7 UP, CAN 330 ML, CAN, 330.000 ML, , LEMON, , 330, ML, 0, 0, 0, 330, 0, , , N, INACTIVE, INACTIVE FROM APRIL 2024, 4, 2, , 202404


Master table column heading references to code:
search_itemcode1: from transaction and refers to 'itemcode'
search_catcode1: from transaction and refers to 'catcode'
search_company1: from transaction and refers to 'company'
search_brand1: from transaction and refers to 'brand'
search_packtype1: from transaction and refers to 'packtype'
search_base_pack1: STRICTLY FROM TRANSACTION WITH NO REFERENCES
search_qty1: from transaction and refers to 'qty'
search_uom1: from transaction and refers to 'uom'
search_itemdesc1: STRICTLY FROM TRANSACTION WITH NO REFERENCES


Transaction table column heading and data:

DATE, PERIOD, AUDITYPE, STORECODE, DLRCODE, ITEMCODE, NEW_CODES, CATEGORY, MANUFACTURE, BRAND, ITEMDESC, MRP, PACKSIZE, PACKTYPE, COMMENTS, IMAGE, CODE COMMENT, FLAG
11/12/2024, 202412, 3, 2110100370, 21101031706, 1.73383E+12, 99765334, 105, JT INTERNATIONAL - SA, CAMEL CONNECT, CAMEL CONNECT ORIGINAL, 161.5, 20, HL, , 1733828064964-jt international - sa-camel connect#3.png, RECODING, 5


Transaction table column heading references:
search_itemcode1: ITEMCODE
search_catcode1: CATEGORY
search_company1: MANUFACTURE
search_brand1: BRAND
search_packtype1: PACKTYPE
search_base_pack1: PACKSIZE
search_qty1: extracted from search_base_pack1
search_uom1: extracted from search_base_pack1
search_itemdesc1: ITEMDESC


##########


1. 'catcode' from transaction needs to be an exact match with 'catcode' from master always
2. 'company' from transaction must be same as 'company' from master
3. 'brand' from transaction must be present in 'brand' from master
4. 'qty' from transaction needs to be an exact match with 'qty' from master always
5. 'uom' from transaction needs to semantically same as 'uom' from master
6. 'packtype' from transaction needs to be semantically same as 'packtype' from master


##########


Rules Recap validation

Rule 1 is correct
Rule 5 is correct
Rule 6 is correct


Rule 4 needs improvement
    For example if qty is 2000 and uom is ML for transaction and qty is 2 and uom is L for master 2000 ML being same as 2 L should match

Rule 3 needs to be researched further to ensure that brand matching is robust and accounts for variations in naming or packaging
    For example if brand in transaction is "Coca-Cola" and in master it is "Coca Cola" or "CocaCola" they should be considered a match
    Also if brand in transaction is Camel Connect and in master is Camel Connect Original or Camel Connect Mint Fresh they should be considered a match since 'Camel Connect' is present in both

Rule 2 needs to be researched further to ensure that company matching is robust and accounts for variations in naming or packaging


Assign every mapping a score between 0 to 100 to showcase how close the match is
And sort the df's filtered on basis of the score from highest to lowest
Make a score column for every pass
And in the final df add a column for scores as well


##########


Revised Rules validation

Rule 4
If even after conversion qty and uom from transaction and master are not same then it is a mismatch
    For example if qty is 2000 and uom is ML for transaction and qty is 2 and uom is L for master 2000 ML being same as 2 L should match
    But if qty is 2000 and uom is ML for transaction and qty is 3 and uom is L for master then it should be a mismatch
    Or if qty is 2000 and uom is ML for transaction and qty is 2 and uom is KG for master then it should be a mismatch
    Or if qty is 2000 and uom is ML for transaction and qty is 2 and uom is "" for master then it should be a mismatch
    
No scoring required for catcode qty uom and packtype since they are exact or semantic matches


##########


Since we follow a pass based mechanism for filtering according to the rules discussed till now
    After pass 1 which is catcode keep only those rows which have catcode match
    After pass 2 which is company keep only the top 5 rows with highest scores if there are multiple matches
    After pass 3 which is brand keep only the top 5 rows with highest scores if there are multiple matches
    After pass 4 which is qty and uom keep only those rows which have qty and uom match
    After pass 5 which is packtype keep only those rows which have packtype match

If at the end of all passes there are multiple rows then keep only the top 3 rows with highest scores


##########

|INFO| MASTER FILE unique packtype:
 ['CAN' 'PET' 'RGB' 'TPK' 'PPH' nan 'TIN' 'JAR' 'PLPCH' 'EWRPK' 'CDBOX'
 'PLCNT' 'PLCUP' 'PLSCH' 'PLBOT' 'ALTIN' 'GLBOT' 'PLJAR' 'GLJAR' 'TUBE'
 'UNWRP' 'STP' 'PCN' 'PLAST' 'TIN C' 'HL' 'SC' 'SB' 'SS']
|INFO| MASTER FILE unique uom:
 ['ML' nan 'GM' 'NO']

|INFO| TRANSACTION FILE unique packtype:
 ['TPK' 'PET' 'PBT' 'CAN']
|INFO| TRANSACTION FILE unique uom:
 {' ML', 'ML', 'ML '}


##########